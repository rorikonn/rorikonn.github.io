---
aliases:
  - Enhanced Input System
tags:
  - 虚幻引擎

title: 增强输入系统
date: 2025-08-01
author: jimmyzou
toc_number: true
decscription: 
---

---
### 玩家自定义按键

- UI处理流程参考`ULyraSettingKeyboardInput`

- 调用`UEnhancedInputUserSettings::MapPlayerKey`来应用新的按键绑定。

``` cpp
bool ULyraSettingKeyboardInput::ChangeBinding(int32 InKeyBindSlot, FKey NewKey)
{
    if (!NewKey.IsGamepadKey())
    {
        FMapPlayerKeyArgs Args = {};
        Args.MappingName = ActionMappingName;
        Args.Slot = (EPlayerMappableKeySlot) (static_cast<uint8>(InKeyBindSlot));
        Args.NewKey = NewKey;
   
        if (UEnhancedInputUserSettings* Settings = GetUserSettings())
        {
            FGameplayTagContainer FailureReason;  
            Settings->MapPlayerKey(Args, FailureReason);  
            NotifySettingChanged(EGameSettingChangeReason::Change);  
        }
        return true;
    }
    
    return false;  
}
```

- 调用`UEnhancedInputUserSettings::ResetAllPlayerKeysInRow`来恢复默认按键。

```cpp
void ULyraSettingKeyboardInput::ResetToDefault()
{
    if (UEnhancedInputUserSettings* Settings = GetUserSettings())
    {
        FMapPlayerKeyArgs Args = {};
        Args.MappingName = ActionMappingName;
        
        FGameplayTagContainer FailureReason;
        Settings->ResetAllPlayerKeysInRow(Args, FailureReason);
        
        NotifySettingChanged(EGameSettingChangeReason::Change);
    }
}
```